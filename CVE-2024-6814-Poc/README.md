## 	CVE-2024-6814
## VULNERABILITY DETAILS
This vulnerability allows remote attackers to execute arbitrary code on affected installations of NETGEAR ProSAFE Network Management System. Authentication is required to exploit this vulnerability.

The specific flaw exists within the getFilterString method. The issue results from the lack of proper validation of a user-supplied string before using it to construct SQL queries. An attacker can leverage this vulnerability to execute code in the context of SYSTEM.

## VULNERABILITY
NMS300_V1.7.0.34(Win64) (tested)

Package: com.elite.wifi.manager.web.page

Class: Limit

Method: getFilterString

![image](https://github.com/user-attachments/assets/ade9711d-e1be-4695-af86-8cfcdde4ee6a)

## Poc:

Check C:\Program Files\NMS300\NMS300\apache-tomcat-6.0.33\webapps\ROOT\WEB-INF\spring-servlet.xml
![image](https://github.com/user-attachments/assets/8482d9d6-832e-4ad4-ab20-a715b5b48515)

Namespace: The <context:component-scan> element is part of the Spring Context namespace. You need to ensure that you have the appropriate XML namespaces declared at the top of your spring-servlet.xml file.

base-package: The base-package attribute specifies the package(s) that Spring should scan for annotations like @Controller, @Service, @Repository, and others. This helps in automatically detecting and registering these types of components with the Spring application context


package com.elite.wifi.manager.web.action

Class: UserPageController
![image](https://github.com/user-attachments/assets/d5c34d57-83bb-4d8d-b90b-1a1c577b9640)

![image](https://github.com/user-attachments/assets/8cc26d1a-eb84-4fef-a315-6cfb1db59dfe)

package com.elite.wifi.manager.dbservice.file

Class: ExcelFileDownService

Method: getPageExportFields
![image](https://github.com/user-attachments/assets/645392c0-0ffe-41b8-9add-aa434d20e80f)

package com.elite.wifi.manager.persistent.dao.file

Class: ExcelFileDownDao

Method: getPageResult
![image](https://github.com/user-attachments/assets/29093a35-0cfe-491a-9a64-1f3e98448038)

package com.elite.wifi.manager.comm.dao;

Class: BaseCrudDao

Method: getPageListBySql
![image](https://github.com/user-attachments/assets/6655b336-f328-42f5-8e02-b5332ccb4881)

package com.elite.wifi.manager.comm.dao;

Class: BaseDao

Method: getListByPagination
![image](https://github.com/user-attachments/assets/c7542cee-ca39-4bc3-a386-e664b2028a2c)

package com.elite.wifi.manager.web.page;

Class: PagedStatement
![image](https://github.com/user-attachments/assets/bfd386f9-7dab-4b02-8256-90eeb6817128)

package com.elite.wifi.manager.web.page;

Class: Limit

Method: getFilterString
![image](https://github.com/user-attachments/assets/62d90855-91a1-423e-9cad-469e81675a11)

https://github.com/user-attachments/assets/4cb215df-4c38-4834-beca-f0478f601119

## References:
- https://www.zerodayinitiative.com/advisories/ZDI-24-901/
- https://kb.netgear.com/000066232/Security-Advisory-for-SQL-Injection-on-the-NMS300-PSV-2024-0019


